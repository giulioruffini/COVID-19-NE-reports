\documentclass[11pt]{article}
\usepackage{geometry}                % See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   % ... or a4paper or a5paper or ... 
%\geometry{landscape}                % Activate for for rotated page geometry
%\usepackage[parfill]{parskip}    % Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{epstopdf}
\DeclareGraphicsRule{.tif}{png}{.png}{`convert #1 `dirname #1`/`basename #1 .tif`.png}

\title{Covid-19 SIR model implementation}
\author{G. Ruffini,  R. Sanchez-Todo, M.C. Biagi, R. Salvador, E. Lleial \\  Neuroelectrics Research \\ v1.0, March 27 2020}
%\date{}                                           % Activate to display a given date or no date

\begin{document}
\maketitle
\section{Introduction}
In this note we provide the basic modeling elements for a Covid-19 SIR model (a simple compartment model further described below) for parameter estimation, short and medium term forecasting. Although there are much more sophisticated models out there\footnote{\tt Arenas A, Cota W, G\'omez-Gardeñes J, G\'omez S, Granell C, Matamalas JT, Soriano D, Steinegger B. A mathematical model for the spatiotemporal epidemic spreading of COVID19. medRxiv 2020.03.21.20040022
https://doi.org/10.1101/2020.03.21.20040022}, a simple approach can be useful for coarse estimation.  In particular, they reinforce the message that in a pandemic such as the one we are currently experience, action must be taken quickly and decisively\footnote{\tt Mitj\`a O, Arenas A, Rod\'o X, Tobias A, Brew J, Benlloch JM on behalf of 62 signatories. Experts' request to the Spanish Government: move Spain towards complete lockdown. The Lancet 2020 (Published online March 26).
https://doi.org/10.1016/S0140-6736(20)30753-4}.


\begin{itemize}
\item We focus on specific geographic areas and treat them as closed for parameter estimation and short and medium forecasting only
\item We employ a simple SIR model\footnote{{\tt  https://web.stanford.edu/~jhj1/teachingdocs/Jones-on-R0.pdf} and Heatcote 2000 ({\tt https://epubs.siam.org/doi/10.1137/S0036144500371907})}, and focus on fatality data as a good proxy for infections days before (13, based on literature median time from infection to death\footnote{\tt https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7074197})
\end{itemize}

\section{SIR model (Jones 2007)}
The following is essentially from Jones 2007:
\begin{quote}
A well-mixed population is one where any infected individual has a probability of contacting any susceptible individual that is reasonably well approximated by the average. This is often the most problematic assumption, but is easily relaxed in more complex models.  In a closed population of $N$ individuals, say that $S$ are susceptible, $I$ infected, and $R$ are removed. Write $s=S / N, i=I / N, r=R / N$ to denote the fraction in each compartment. The SIR model is then:

\begin{eqnarray}
\frac{d s}{d t} &=-\beta s i \\
\frac{d i}{d t} &=\beta s i-\nu i \\
\frac{d r}{d t} &=\nu i
\end{eqnarray}
where $\beta=\tau \bar{c}$ and is known as the effective contact rate, $\nu$ is the removal rate. By assumption all the rates are constant. This means that the expected duration of infection is simply the inverse of the removal rate: $d=\nu^{-1}$.
\end{quote}




\section{Parameter estimation}
Parameters for the model are estimated from the literature or from available data from Spain and Italy. In particular, the effect of social mobility restriction measures on $R_t$ are estimated from Italian data. We fit fatality data as a proxy of infections 13 days earlier. 




We can use current data to set some parameters\footnote{http://gabgoh.github.io/COVID/index.html}. The SIR model has two main parameters, $\beta$ and $\nu$, where $\beta$ is the effective contact rate, and $\nu=1/d$ the removal rate, where $d$ is the expected duration of the infection. 

These two parameters connect with $R_0$: 
$$
R_0=\beta/\nu
$$
What do we know today?  From initial estimates in the literature, 
$$
R0 \approx 2
$$
and we assume that an individual is actively infectious (shedding and not confined, with our without symptoms) for
$$
d=5 \mbox{ days}
$$
Then 
$$
\nu= 1/ 5  \mbox{ perday} 
$$
and 
$$
\beta= \nu \, R_0 = 1.1 \mbox{ perday}  
$$

At the beginning of the epidemic, $s\approx 1$, and the growth is exponential, with 
$$
\frac{di}{dt}\approx (\beta-\nu) \,i
$$
with an exponential growth of $\beta-\nu $ perday.



Then, solving, at start of epidemic,
$$
i(t) \approx i_0 \, e^{(\beta-\nu) \,t}
$$
The doubling time is obtained by equating
$$
2^{t/\tau^0_2} = e^{(\beta-\nu) \,t}
$$
or, taking log in base e of both sides,
%$$
%(\ln 2 )/\tau^0_2 = \beta - \nu
%$$
$$
\tau_2^0 = \frac{\ln {2}}{\beta - \nu} 
$$


\subsection*{Estimation of dynamic doubling time}



A second order polynomial fit is carried out on the log (base 2) of the fatality data.  
A robust approach is to simply compute the derivative of the polynomial to obtain the slope and from that the doubling time. 

An alternative is to write
$$
f(t) =2^{a_0+a_1 t + a_2 t^2}
$$
What is the doubling time at time $t$? We set
$$
2= \frac{f(t+\tau_2)}{f(t)} =  \frac{2^{a_1 (t+\tau_2) + a_2 (t+\tau_2)^2}}{2^{a_1 t + a_2 t^2}} 
$$
%or 
%$$
%1= a_1 (t+\tau_2) + a_2 (t+\tau_2)^2 - a_1 t - a_2 t^2 
%$$
%or
%$$
%1 = a_1\tau_2 +a_2\tau_2^2 +2a_2 \tau_2 t 
%$$
%or
%$$
%a_2\tau_2^2 + (a_1+2a_2t) \tau_2 -1 =0
%$$
so 
$$
\tau_2 (t)= \frac{-(a_1+2a_2t) + \sqrt{ (a_1+2a_2t)^2 + 4a_2} }{2 a_2}
$$

\subsection{Infected to detected ratio}
A critical parameter for medium term forecast is to account for the infection rate, not simply the detection rate. If many people are infected but do not appear in the statistics and model, then the model will not reflect a faster saturation of infections and a smaller number of cumulative fatalities.
E.g,. it is estimated that about 15\% of people were infected in Spain (10\% in Italy) as of March 28th 2020\footnote{https://www.imperial.ac.uk/media/imperial-college/medicine/sph/ide/gida-fellowships/Imperial-College-COVID19-Europe-estimates-and-NPI-impact-30-03-2020.pdf}.

\section{Model}
We have implemented the SIR model in Python. The model predicts the number infections  and IFR (infection fatality rate)  is estimated as a percent of infections (to match with data). 


\begin{itemize}
\item Measures taken at time T in real life are implemented T+13 days later in the model to account for latency.
\item ICU occupancy is estimated as a simple percent of active cases.
\item IFR is estimated about 1.3\%\footnote{https://www.eurosurveillance.org/content/10.2807/1560-7917.ES.2020.25.12.2000256?emailalert=true.}). The steps for parameter estimation and data fitting are as follows.
\end{itemize}

\section{Model outputs: short  and medium term }
The model is run for 2 weeks since the last available data to predict fatalities and ICU occupancy (N). 

For medium term forecasting, the model is run for 2 months.


\section{Disclaimer}
The Neuroelectrics research team is specialized in computational neuroscience and physical modeling of the brain, and our work in epidemiology must be considered with healthy skepticism. We believe, however, that Covid-19 is going to stay with us for quite some time, and that any help we can provide will be useful in the end. There is no more urgent problem to work on at the moment.


\end{document}  